<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Posts van <%= username %></title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/style-navbar.css">
    <link rel="stylesheet" href="/css/style-posts.css">
</head>
<body>
    <%- include('navbar') %>
    
    <div class="user-posts-container">
        <h1>Posts of <%= username %></h1>
        
        <% if (isOwnProfile) { %>
            <a href="/posts/new" class="new-post-btn">
                <button>Make new post</button>
            </a>
        <% } %>

        <% if (isPrivate && !isOwnProfile && !(following && followed)) { %>
            <p>This user's posts are private.</p>
        <% } else { %>
        
        <% if (posts.length === 0) { %>
            <p><%= isOwnProfile ? 'You have no posts yet.' : 'This user has no posts yet.' %></p>
        <% } else { %>
            <div class="posts-grid">
                <% posts.forEach(post => { %>
                    <div class="post">
                        <div class="post-header">
                            <h3>
                                <a href="/user/<%= post.username %>"><%= post.username %></a>
                            </h3>
                        </div>

                        <p class="post-caption"><%= post.caption %></p>
                        
                        <!-- Toon alle foto's -->
                        <% if (post.images && post.images.length > 0) { %>
                            <div class="post-images">
                                <% post.images.forEach(imagePath => { %>
                                    <img src="<%= imagePath %>" alt="Post foto" style="max-width: 100%; margin: 5px 0;">
                                <% }) %>
                            </div>
                        <% } %>
                        
                        <small><%= new Date(post.created_at).toLocaleString('nl-BE') %></small>
                        
                        <% if (isOwnProfile) { %>
                            <form action="/posts/delete" method="POST" style="display:inline; margin-top: 10px;">
                                <input type="hidden" name="id" value="<%= post.id %>">
                                <button type="submit" class="delete-btn">Delete</button>
                            </form>
                        <% } %>

                        <div class="post-actions">
                            <form action="/posts/save" method="POST" style="display: inline;">
                                <input type="hidden" name="postId" value="<%= post.id %>">
                                <button type="submit" class="<%= post.isSaved ? 'unsave-btn' : 'save-btn' %>">
                                    <%= post.isSaved ? 'Saved' : 'Save' %>
                                </button>
                            </form>
                        </div>

                    </div>
                    <hr>
                <% }) %>
            </div>
        <% } %>

        <% } %>
        
        <br>
        <a href="<%= isOwnProfile ? '/profile' : '/user/' + username %>">
            <button>Back to profile</button>
        </a>
    </div>
</body>
</html>
